<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‘ê·¼ë‘ê·¼ ë°œí‘œì ë½‘ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.min.js"></script>
    <style>
        :root {
            --bg-main: #FFFBF5;
            --bg-display: #FCEFEF;
            --bg-celebrate: #FFF2A1;
            --color-start: #4A90E2;
            --color-stop: #FF6B6B;
            --color-feature: #4ECDC4;
            --text-default: #333333;
            --text-winner: #FF6B6B;
        }
        body {
            font-family: 'Gowun Dodum', sans-serif;
            background-color: var(--bg-main);
        }
        .result-display {
            font-weight: 900;
            font-size: 12rem;
            line-height: 1;
            text-shadow: 4px 4px 10px rgba(0,0,0,0.08);
            color: var(--text-default);
            transition: color 0.3s ease-in-out;
        }
        .characteristic-display {
            font-weight: 700;
            font-size: 2.5rem;
            line-height: 1.4;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.08);
            color: var(--text-default);
            transition: color 0.3s ease-in-out;
            word-break: keep-all; /* ë‹¨ì–´ ë‹¨ìœ„ ì¤„ë°”ê¿ˆ */
        }
        .winner {
            color: var(--text-winner) !important;
        }
        .btn-primary {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.1);
            border: none;
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px 0 rgba(0, 0, 0, 0.15);
        }
        .btn-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        @media (min-width: 640px) {
            .result-display { font-size: 15rem; }
            .characteristic-display { font-size: 2.8rem; }
        }
    </style>
</head>
<body class="text-slate-800 flex flex-col items-center justify-center min-h-screen p-4 antialiased">
    <div class="absolute top-4 right-4 text-xs text-slate-400">
        ë³´ë¼ìŒ¤ê³¼ ì—­ì‚¬ë¥¼ ë³´ë¼
    </div>

    <div class="w-full max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl shadow-rose-100 p-6 md:p-10 text-center">
        
        <h1 class="text-3xl sm:text-4xl font-bold text-slate-700 mb-2 whitespace-nowrap">ë‘ê·¼ë‘ê·¼ ë°œí‘œì ë½‘ê¸°</h1>
        <p class="text-slate-500 mb-8">ì˜¤ëŠ˜ì˜ í–‰ìš´ì˜ ì£¼ì¸ê³µì€ ëˆ„êµ¬ì¼ê¹Œìš”?</p>

        <div id="display-area" class="rounded-2xl min-h-[300px] md:min-h-[350px] flex items-center justify-center my-6 p-4" style="background-color: var(--bg-display); transition: background-color 0.1s ease;">
            <div id="result" class="result-display select-none">?</div>
            <div id="characteristic-result" class="characteristic-display select-none hidden px-4"></div>
        </div>
        
        <div>
            <div class="flex justify-center border-b border-rose-100 mb-6">
                <button id="tab-number" class="px-6 py-3 font-bold border-b-2 transition-colors">ë²ˆí˜¸</button>
                <button id="tab-characteristic" class="px-6 py-3 font-bold text-slate-400 transition-colors">íŠ¹ì§•</button>
            </div>
            
            <div id="number-picker-controls">
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                    <div class="relative w-full sm:w-auto">
                        <label for="student-count" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-slate-500">ì´ í•™ìƒ ìˆ˜</label>
                        <input type="number" id="student-count" min="1" class="w-full sm:w-48 text-center text-lg px-4 py-3 rounded-xl border border-slate-300 focus:ring-2" style="--tw-ring-color: var(--color-start); border-color: var(--color-start);">
                    </div>
                    <button id="start-btn" class="w-full sm:w-auto text-lg font-bold text-white px-8 py-3 rounded-xl btn-primary" style="background-color: var(--color-start);">
                        ì‹œì‘
                    </button>
                    <button id="stop-btn" class="w-full sm:w-auto text-lg font-bold text-white px-8 py-3 rounded-xl btn-primary" style="background-color: var(--color-stop);" disabled>
                        ë©ˆì¶¤!
                    </button>
                </div>
                <p id="error-msg" class="text-red-500 h-6 mt-2 text-sm"></p>
            </div>

            <div id="characteristic-picker-controls" class="hidden">
                 <button id="pick-characteristic-btn" class="w-full sm:w-auto text-lg font-bold text-white px-10 py-4 rounded-xl btn-primary" style="background-color: var(--color-feature);">
                    ë‹¤ì‹œ ë½‘ê¸°!
                </button>
            </div>
        </div>
    </div>

    <script>
    window.addEventListener('DOMContentLoaded', () => {
        const resultDiv = document.getElementById('result');
        const studentCountInput = document.getElementById('student-count');
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const errorMsg = document.getElementById('error-msg');
        const displayArea = document.getElementById('display-area');
        const characteristicResultDiv = document.getElementById('characteristic-result');
        const pickCharacteristicBtn = document.getElementById('pick-characteristic-btn');

        const tabs = {
            number: document.getElementById('tab-number'),
            characteristic: document.getElementById('tab-characteristic')
        };
        const controls = {
            number: document.getElementById('number-picker-controls'),
            characteristic: document.getElementById('characteristic-picker-controls')
        };
        const displays = {
            number: resultDiv,
            characteristic: characteristicResultDiv
        }

        let intervalId = null, celebrateIntervalId = null, isSpinning = false, synth = null;
        let audioInitialized = false;
        
        try {
            if (typeof Tone !== 'undefined') {
                synth = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.1, sustain: 0.3, release: 1 } }).toDestination();
            }
        } catch (e) { console.error('Tone.js init failed.', e); }
        
        function playWinnerSound() {
            if (!synth) return;
            const now = Tone.now();
            synth.triggerAttackRelease("C5", "16n", now);
            synth.triggerAttackRelease("E5", "16n", now + 0.1);
            synth.triggerAttackRelease("G5", "8n", now + 0.2);
        }
        function playSurpriseSound() {
            if (!synth) return;
            const now = Tone.now();
            synth.triggerAttackRelease("C4", "8n", now);
            synth.triggerAttackRelease("G4", "8n", now + 0.2);
            synth.triggerAttackRelease("C5", "8n", now + 0.4);
            synth.triggerAttackRelease("E5", "8n", now + 0.6);
            synth.triggerAttackRelease("G5", "4n", now + 0.8);
        }
        
        async function initAudio() {
            if (!audioInitialized && typeof Tone !== 'undefined' && Tone.context.state !== 'running') {
                await Tone.start();
                console.log("Audio context started!");
                audioInitialized = true;
            }
        }

        const characteristics = ["ì˜¤ëŠ˜ ê°€ì¥ ì¼ì° ë“±êµí•œ ì‚¬ëŒ", "ìƒì¼ì´ ì˜¤ëŠ˜ ë‚ ì§œì™€ ê°€ì¥ ê°€ê¹Œìš´ ì‚¬ëŒ", "ì–´ì œ ì €ë…ìœ¼ë¡œ ë©´ ìš”ë¦¬ë¥¼ ë¨¹ì€ ì‚¬ëŒ", "ì–´ì œ ì €ë…ìœ¼ë¡œ ë°¥ì´ ì•„ë‹Œ ë‹¤ë¥¸ ê²ƒì„ ë¨¹ì€ ì‚¬ëŒ", "ë°˜ì—ì„œ ë¨¸ë¦¬ê°€ ê°€ì¥ ê¸´ ì‚¬ëŒ", "ë°˜ì—ì„œ ë¨¸ë¦¬ê°€ ê°€ì¥ ì§§ì€ ì‚¬ëŒ", "ì˜¤ëŠ˜ êµê³¼ì„œë¥¼ ì•ˆ ê°€ì ¸ì˜¨ ì‚¬ëŒ", "ë°œ ì‚¬ì´ì¦ˆê°€ 230mm ì´í•˜ì¸ ì‚¬ëŒ", "ë°œ ì‚¬ì´ì¦ˆê°€ 270mm ì´ìƒì¸ ì‚¬ëŒ", "í‚¤ê°€ 180cmì— ê°€ì¥ ê°€ê¹Œìš´ ì‚¬ëŒ", "í‚¤ê°€ 150cmì— ê°€ì¥ ê°€ê¹Œìš´ ì‚¬ëŒ", "í•„í†µ ì†ì— ê°€ì¥ ê¸´ íœì„ ê°€ì§„ ì‚¬ëŒ", "íœ´ëŒ€í° ë°°ê²½í™”ë©´ì´ ê¸°ë³¸ ì´ë¯¸ì§€ì¸ ì‚¬ëŒ", "ë§¨ ë’·ì¤„ ê°€ìš´ë° ìë¦¬ì— ì•‰ì€ ì‚¬ëŒ", "ì˜¤ëŠ˜ íŒŒë€ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ì€ ì‚¬ëŒ", "ì£¼ë¨¸ë‹ˆì— ë™ì „ì´ ìˆëŠ” ì‚¬ëŒ", "ì´ë¦„ì´ 4ê¸€ìì¸ ì‚¬ëŒ", "ì˜¤ëŠ˜ ì•„ì¹¨ ê¸‰ì‹ ë©”ë‰´ë¥¼ ê¸°ì–µí•˜ëŠ” ì‚¬ëŒ", "ì–´ì œ ë°¤ 11ì‹œ ì´ì „ì— ì ë“  ì‚¬ëŒ", "ì˜¤ëŠ˜ ì•„ì¹¨ì— ìš°ìœ ë¥¼ ë§ˆì‹  ì‚¬ëŒ", "í•™ë²ˆì´ í™€ìˆ˜ì¸ ì‚¬ëŒ", "í•™ë²ˆì´ ì§ìˆ˜ì¸ ì‚¬ëŒ", "ì‹ ë°œëˆì´ ì—†ëŠ” ì‹ ë°œì„ ì‹ ì€ ì‚¬ëŒ", "ì•ˆê²½ì•Œì´ ë™ê·¸ë€ ì‚¬ëŒ", "ê°€ë°© ìƒ‰ì´ ê²€ì€ìƒ‰ì´ ì•„ë‹Œ ì‚¬ëŒ", "í•„í†µì´ í”Œë¼ìŠ¤í‹± ì¬ì§ˆì¸ ì‚¬ëŒ", "ì†ëª©ì‹œê³„ë¥¼ ì°¨ê³  ìˆëŠ” ì‚¬ëŒ", "ì˜¤ëŠ˜ ì²´ìœ¡ë³µì„ ì…ê³  ìˆëŠ” ì‚¬ëŒ", "ì´ë¦„ì˜ ì´ˆì„±ì´ 'ã…‡'ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì‚¬ëŒ", "íƒœì–´ë‚œ ë‹¬ì´ 12ì›”ì¸ ì‚¬ëŒ", "ê°€ì¥ ìµœê·¼ì— ì˜í™”ë¥¼ ë³¸ ì‚¬ëŒ", "ì˜¤ëŠ˜ ì–‘ë§ ìƒ‰ê¹”ì´ í°ìƒ‰ì´ ì•„ë‹Œ ì‚¬ëŒ", "ì°½ê°€ ìª½ ë§¨ ì•ìë¦¬ì— ì•‰ì€ ì‚¬ëŒ", "ë³µë„ ìª½ ë§¨ ë’·ìë¦¬ì— ì•‰ì€ ì‚¬ëŒ", "í˜•ì œ, ìë§¤ê°€ ì—†ëŠ” ì‚¬ëŒ", "ë°˜ë ¤ë™ë¬¼ì„ í‚¤ìš°ëŠ” ì‚¬ëŒ", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³¼ëª©ì´ ì—­ì‚¬ì¸ ì‚¬ëŒ", "ì–´ì œ ìŒì•…ì„ ë“¤ìœ¼ë©° ë“±êµí•œ ì‚¬ëŒ", "í•„í†µì— ìê°€ ì—†ëŠ” ì‚¬ëŒ", "íœ´ëŒ€í° ë°°í„°ë¦¬ê°€ 50% ì´í•˜ì¸ ì‚¬ëŒ", "ì˜¤ëŠ˜ ëŒ€ì¤‘êµí†µì„ íƒ€ê³  ì˜¨ ì‚¬ëŒ", "ìƒì˜ì— ì£¼ë¨¸ë‹ˆê°€ ì—†ëŠ” ì‚¬ëŒ", "ê°€ë°©ì— ì±…ì„ 5ê¶Œ ì´ìƒ ë„£ì–´ì˜¨ ì‚¬ëŒ", "ì–´ì œ ìš´ë™ì„ í•œ ì‚¬ëŒ", "íœ´ëŒ€í° ì¼€ì´ìŠ¤ê°€ íˆ¬ëª…í•œ ì‚¬ëŒ", "ì‰¬ëŠ” ì‹œê°„ì— ì ì„ ì” ì‚¬ëŒ", "ì˜¤ëŠ˜ ì…ì€ ì˜· ì†Œë§¤ê°€ ê°€ì¥ ê¸´ ì‚¬ëŒ", "ê°€ì¥ ìµœê·¼ì— í•„ê¸°í•œ ê¸€ì”¨ ìƒ‰ì´ ê²€ì€ìƒ‰ì´ ì•„ë‹Œ ì‚¬ëŒ", "ì‹ ë°œì— 3ê°€ì§€ ì´ìƒì˜ ìƒ‰ì´ ë“¤ì–´ê°„ ì‚¬ëŒ", "í•„í†µì— ìºë¦­í„° ìŠ¤í‹°ì»¤ê°€ ë¶™ì–´ìˆëŠ” ì‚¬ëŒ"];
        const surprises = ["ğŸ‰ ê¹œì§ ê°„ì‹ ë‹¹ì²¨! ğŸ‰", "âœ¨ ì¹­ì°¬ í­íƒ„ íƒ€ì„! âœ¨", "ğŸŒŸ í–‰ìš´ì˜ ìƒì  ë‹¹ì²¨! ğŸŒŸ", "ğŸ‘ ëª¨ë‘ì˜ í° ë°•ìˆ˜ ë‹¹ì²¨! ğŸ‘", "ğŸ™Œ ëª¨ë‘ì˜ í° í™˜í˜¸ ë‹¹ì²¨! ğŸ™Œ"];

        function startSpinning() {
            initAudio(); // ì˜¤ë””ì˜¤ ì´ˆê¸°í™” í˜¸ì¶œ
            const count = parseInt(studentCountInput.value);
            if (isNaN(count) || count < 1) { errorMsg.textContent = "1 ì´ìƒì˜ í•™ìƒ ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."; return; }
            errorMsg.textContent = "";
            isSpinning = true;
            startBtn.disabled = true;
            studentCountInput.disabled = true;
            stopBtn.disabled = false;
            intervalId = setInterval(() => {
                resultDiv.textContent = Math.floor(Math.random() * count) + 1;
            }, 50);
        }

        function stopSpinning() {
            if (!isSpinning) return;
            clearInterval(intervalId); isSpinning = false;
            startBtn.disabled = false; studentCountInput.disabled = false; stopBtn.disabled = true;
            if (Math.random() < 0.15) {
                const surprise = surprises[Math.floor(Math.random() * surprises.length)];
                switchToView('characteristic', surprise);
                playSurpriseSound();
            } else {
                resultDiv.classList.add('winner');
                playWinnerSound();
            }
            celebrateEffect();
        }

        function startCharacteristicSpin() {
            initAudio(); // ì˜¤ë””ì˜¤ ì´ˆê¸°í™” í˜¸ì¶œ
            if (isSpinning) return;
            isSpinning = true;
            pickCharacteristicBtn.disabled = false;
            pickCharacteristicBtn.textContent = "ë©ˆì¶¤!";
            pickCharacteristicBtn.style.backgroundColor = 'var(--color-stop)';

            intervalId = setInterval(() => {
                const randomChar = characteristics[Math.floor(Math.random() * characteristics.length)];
                characteristicResultDiv.textContent = randomChar;
                characteristicResultDiv.classList.remove('winner');
            }, 80);
        }

        function stopCharacteristicSpin() {
            if (!isSpinning) return;
            clearInterval(intervalId);
            isSpinning = false;
            pickCharacteristicBtn.textContent = "ë‹¤ì‹œ ë½‘ê¸°!";
            pickCharacteristicBtn.style.backgroundColor = 'var(--color-feature)';

            if (Math.random() < 0.15) {
                const surprise = surprises[Math.floor(Math.random() * surprises.length)];
                characteristicResultDiv.textContent = surprise;
                playSurpriseSound();
            } else {
                const chosen = characteristics[Math.floor(Math.random() * characteristics.length)];
                characteristicResultDiv.textContent = chosen;
                playWinnerSound();
            }
            characteristicResultDiv.classList.add('winner');
            celebrateEffect();
        }

        function celebrateEffect() {
            let flashCount = 0;
            if (celebrateIntervalId) clearInterval(celebrateIntervalId);
            celebrateIntervalId = setInterval(() => {
                displayArea.style.backgroundColor = (flashCount % 2 === 0) ? 'var(--bg-celebrate)' : 'var(--bg-display)';
                flashCount++;
                if (flashCount > 5) {
                    clearInterval(celebrateIntervalId);
                    displayArea.style.backgroundColor = 'var(--bg-display)';
                }
            }, 120);
        }

        function resetState() {
            if (intervalId) clearInterval(intervalId);
            if (celebrateIntervalId) clearInterval(celebrateIntervalId);
            displayArea.style.backgroundColor = 'var(--bg-display)';
            Object.values(displays).forEach(d => d.classList.remove('winner'));
            isSpinning = false;
            pickCharacteristicBtn.disabled = false;
        }

        function switchToView(mode, content = null) {
            resetState();
            Object.values(tabs).forEach(t => { t.style.color = '#94a3b8'; t.style.borderColor = 'transparent'; });
            Object.values(controls).forEach(c => c.classList.add('hidden'));
            Object.values(displays).forEach(d => d.classList.add('hidden'));

            const activeColor = `var(--color-${mode === 'characteristic' ? 'feature' : 'stop'})`;
            tabs[mode].style.color = activeColor;
            tabs[mode].style.borderColor = activeColor;
            controls[mode].classList.remove('hidden');
            displays[mode].classList.remove('hidden');

            if (mode === 'number') {
                resultDiv.textContent = '?';
                startBtn.disabled = false; stopBtn.disabled = true; studentCountInput.disabled = false;
            } else if (mode === 'characteristic') {
                 if(content) {
                    characteristicResultDiv.textContent = content;
                    characteristicResultDiv.classList.add('winner');
                    celebrateEffect();
                    pickCharacteristicBtn.textContent = "ë‹¤ì‹œ ë½‘ê¸°!";
                    pickCharacteristicBtn.style.backgroundColor = 'var(--color-feature)';
                 } else {
                    startCharacteristicSpin();
                 }
            }
        }
        
        tabs.number.addEventListener('click', () => switchToView('number'));
        tabs.characteristic.addEventListener('click', () => switchToView('characteristic'));
        
        startBtn.addEventListener('click', startSpinning);
        stopBtn.addEventListener('click', stopSpinning);
        
        pickCharacteristicBtn.addEventListener('click', () => {
            if (isSpinning) {
                stopCharacteristicSpin();
            } else {
                startCharacteristicSpin();
            }
        });
        
        studentCountInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') startSpinning(); });
        
        switchToView('number');
    });
    </script>
</body>
</html>


